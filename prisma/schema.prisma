generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = "postgresql://postgres:postgres@localhost:5432/fint_db"
}

model User {
  id             String         @id @default(uuid())
  email          String         @unique
  password       String
  name           String
  role           Role           @default(VIEWER)
  organizationId String?
  resetToken     String?
  resetTokenExpiry DateTime?
  createdAt      DateTime       @default(now())
  updatedAt      DateTime       @updatedAt
  accounts       Account[]
  journalEntries JournalEntry[]
  transactions   Transaction[]
}

model Account {
  id            String         @id @default(uuid())
  name          String
  type          String
  code          String         @unique
  userId        String
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  user          User           @relation(fields: [userId], references: [id])
  creditEntries JournalEntry[] @relation("CreditAccount")
  debitEntries  JournalEntry[] @relation("DebitAccount")
}

model JournalEntry {
  id              String   @id @default(uuid())
  date            DateTime
  description     String
  amount          Float
  debitAccountId  String
  creditAccountId String
  userId          String
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  creditAccount   Account  @relation("CreditAccount", fields: [creditAccountId], references: [id])
  debitAccount    Account  @relation("DebitAccount", fields: [debitAccountId], references: [id])
  user            User     @relation(fields: [userId], references: [id])
}

model Transaction {
  id              String   @id @default(uuid())
  date            DateTime
  description     String
  amount          Float
  category        String
  transactionType String
  userId          String
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  user            User     @relation(fields: [userId], references: [id])
}

enum Role {
  ADMIN
  ACCOUNTANT
  VIEWER
}
